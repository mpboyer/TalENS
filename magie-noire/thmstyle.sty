\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{thmstyle}

\RequirePackage[svgnames, table]{xcolor}
\RequirePackage[outline]{contour}
\RequirePackage{soul}
\RequirePackage{changepage}
\definecolor{vulm}{HTML}{7d1dd3}
\definecolor{yulm}{HTML}{ffe500}


%----------------------------------------------------------------------------------------
%       THEOREM STYLES
%----------------------------------------------------------------------------------------

\RequirePackage{amsmath, amsfonts, amssymb, amsthm}

\renewcommand{\qedsymbol}{$\blacksquare$}

\RequirePackage{dsfont}

\RequirePackage{mathtools}

%------------------------------------------------

% Orange theorem number and optional black title with padding above and below
\newtheoremstyle{vulmnum}
        {6pt}
        {6pt}
        {\normalfont}
        {}
        {}
        {}
        {0.25em}
        {\small\sffamily\bfseries\color{vulm}\thmname{#1}~\thmnumber{\@ifnotempty{#1}{}\@upn{#2}}
        \thmnote{\the\thm@notefont\sffamily\bfseries\color{black}---~#3.\hspace{0.25em}}}

%------------------------------------------------

        \setulcolor{yulm}

% Orange theorem number and optional black title with no padding above and below
\newtheoremstyle{vulmnumbox}
        {0pt}
        {0pt}
        {\normalfont}
        {}
        {}
        {}
        {0.25em}
        {\small\sffamily\bfseries\color{vulm}\thmname{ #1}~\thmnumber{ \@ifnotempty{#1}{}\@upn{#2}}
\thmnote{ \the\thm@notefont\sffamily\bfseries\color{black}---~#3\hspace{0.25em}}}

%------------------------------------------------

% Black theorem number and optional black title no padding above and below
\newtheoremstyle{blacknumex}
        {6pt}
        {6pt}
        {\normalfont}
        {}
        {}
        {}
        {0.25em}
        {\small\sffamily\bfseries{\raisebox{1.25pt}{\tiny\ensuremath{\blacksquare}}}~\thmname{#1}~\thmnumber{\@ifnotempty{#1}{}\@upn{#2}}
        \thmnote{\the\thm@notefont\sffamily\bfseries---~#3.\hspace{0.25em}}}

%------------------------------------------------

% Black theorem number and optional black title padding above and below
\newtheoremstyle{blacknumbox}
        {0pt}
        {0pt}
        {\normalfont}
        {}
        {}
        {}
        {0.25em}
        {\small\sffamily\bfseries\thmname{#1}~\thmnumber{\@ifnotempty{#1}{}\@upn{#2}}
        \thmnote{\the\thm@notefont\sffamily\bfseries---~#3.\hspace{0.25em}}}

%------------------------------------------------

% Set the theorem style for each type of theorem-like environment by placing it under the theorem style you would like to use for it

% Orange theorem number and optional black title with padding above and below
\theoremstyle{vulmnum}
\newtheorem{proposition}{Proposition}[section]
\newtheorem{remarqueT}{Remarque}[section]

% Orange theorem number and optional black title with no padding above and below
\theoremstyle{vulmnumbox}
\newtheorem{theoremeT}{Théorème}[section]
\newtheorem{problemT}{Problème}[section]
\newtheorem{exerciseT}{Exercice}[section]
\newtheorem{astT}{Astuce}[section]
\newtheorem{correctionT}{Correction}[section]

% Black theorem number and optional black title no padding above and below
\theoremstyle{blacknumex}
\newtheorem{exampleT}{Exemple}[section]
\newtheorem{notationT}{Notation}[section]
\newtheorem{vocabulary}{Vocabulaire}[section]

% Black theorem number and optional black title with padding above and below
\theoremstyle{blacknumbox}
\newtheorem{definitionT}{Définition}[section]
\newtheorem{corollaryT}{Corollaire}[section]
\newtheorem{lemme}{Lemme}[section]

%----------------------------------------------------------------------------------------
%       COLORED THEOREM BOXES
%----------------------------------------------------------------------------------------

\RequirePackage[framemethod=default]{mdframed}

% Theorem box
\newmdenv[
        skipabove=7pt,
        skipbelow=7pt,
        backgroundcolor=yulm!15!white,
        linecolor=vulm,
        innerleftmargin=5pt,
        innerrightmargin=5pt,
        innertopmargin=5pt,
        innerbottommargin=5pt,
        leftmargin=0cm,
        rightmargin=0cm
]{tBox}

% Exercise box
\newmdenv[
        skipabove=7pt,
        skipbelow=7pt,
        rightline=false,
        leftline=true,
        topline=false,
        bottomline=true,
        linecolor=vulm,
        linewidth=2pt,
        backgroundcolor=white,
        innerleftmargin=9pt,
        innerrightmargin=5pt,
        innertopmargin=5pt,
        innerbottommargin=5pt,
        leftmargin=0cm,
        rightmargin=0cm
]{eBox}

% Definition box
\newmdenv[
        skipabove=7pt,
        skipbelow=7pt,
        rightline=true,
        leftline=true,
        topline=true,
        bottomline=true,
        backgroundcolor=white,
        linecolor=vulm,
        innerleftmargin=5pt,
        innerrightmargin=5pt,
        innertopmargin=5pt,
        innerbottommargin=5pt,
        leftmargin=0cm,
        rightmargin=0cm
]{dBox}


% Corollary box
\newmdenv[
        skipabove=7pt,
        skipbelow=7pt,
        rightline=false,
        leftline=true,
        topline=false,
        bottomline=false,
        linecolor=gray,
        linewidth=4pt,
        backgroundcolor=yulm!15!white,
        innerleftmargin=5pt,
        innerrightmargin=5pt,
        innertopmargin=5pt,
        innerbottommargin=5pt,
        leftmargin=0cm,
        rightmargin=0cm
]{cBox}


\newmdenv[
        skipabove=7pt,
        skipbelow=7pt,
        rightline=false,
        leftline=true,
        topline=false,
        bottomline=false,
        linecolor=vulm,
        linewidth=4pt,
        backgroundcolor=white,
        innerleftmargin=9pt,
        innerrightmargin=5pt,
        innertopmargin=5pt,
        innerbottommargin=5pt,
        leftmargin=0cm,
        rightmargin=0cm
]{sBox}

\newmdenv[
        skipabove=7pt,
        skipbelow=7pt,
        rightline=true,
        leftline=true,
        topline=true,
        bottomline=true,
        linecolor=vulm,
        linewidth=1pt,
        backgroundcolor=yulm!5!white,
        innerleftmargin=10pt,
        innerrightmargin=10pt,
        innertopmargin=5pt,
        innerbottommargin=5pt,
        leftmargin=0cm,
        rightmargin=0cm
]{lBox}

\newmdenv[
        skipabove=7pt,
        skipbelow=7pt,
        rightline=true,
        leftline=true,
        topline=true,
        bottomline=true,
        linecolor=vulm!50!black,
        linewidth=.3pt,
        backgroundcolor=yulm!5!white,
        innerleftmargin=10pt,
        innerrightmargin=10pt,
        innertopmargin=5pt,
        innerbottommargin=5pt,
        leftmargin=0cm,
        rightmargin=0cm
]{codeBox}



\RequirePackage{fontawesome5}

% Creates an environment for each type of theorem and assigns it a theorem text style from the THEOREM STYLES block above and a colored box from above
\newenvironment{thm}{\begin{tBox}\begin{theoremeT}}{\end{theoremeT}\end{tBox}}
\newenvironment{exo}[2][0]{\begin{eBox}
\begin{exerciseT}[\ifnum #1=1
        \faPencil*\
\else \ifnum #1=2
        \faBicycle\
\else \ifnum #1=3
        \faMountain\
\fi
\fi
\fi\ifstrempty{#2}{}{#2.}]}{\end{exerciseT}\end{eBox}}
\newenvironment{corr}{\begin{eBox}\begin{correctionT}}{\end{correctionT}\end{eBox}}
\newenvironment{astuce}{\begin{eBox}\begin{astT}}{\end{astT}\end{eBox}}
\newenvironment{definition}{\begin{dBox}\begin{definitionT}}{\end{definitionT}\end{dBox}}
\newenvironment{exemple}{\begin{exampleT}}{\hfill{\tiny\ensuremath{\blacksquare}}\end{exampleT}}
\newenvironment{corollaire}{\begin{cBox}\begin{corollaryT}}{\end{corollaryT}\end{cBox}}
\newenvironment{remarque}{%
        \par\small
        \vspace{5pt}
        \begin{adjustwidth}{35pt}{25pt}
                \hspace{-3pt}%
                \begin{tikzpicture}[overlay]
                        \node[draw=vulm!60,line width=1pt, rectangle,fill=vulm!25,font=\sffamily\bfseries,inner sep=3pt,outer sep=0pt] at (-15pt,0pt){\textcolor{vulm}{R}};
                \end{tikzpicture}
        \advance\baselineskip -1pt% Reduce line spacing
}{%
        \end{adjustwidth}
}
